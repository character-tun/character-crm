# Character Tuning CRM/ERP

CRM/ERP система для детейлинга, тюнинга и автохимии.

## Установка и запуск

1. Установите зависимости для сервера:
   ```
   npm install
   ```

2. Установите зависимости для клиента:
   ```
   npm run install-client
   ```

3. Запустите приложение в режиме разработки:
   ```
   npm run dev
   ```

## Основные функции

- Управление клиентами
- Заказы на детейлинг
- Управление продуктами и запасами
- Календарь и планирование
- Финансовый учет
- Управление производством

## Технологии

- Frontend: React, Material-UI
- Backend: Node.js, Express
- Database: MongoDB

## Быстрый запуск (DEV mode)

- Скопируйте пример окружения: `cp .env.example .env`.
- Убедитесь, что в `.env` включён DEV-режим: `AUTH_DEV_MODE=1`.
- Установите зависимости: `npm install` и `npm run install-client`.
- Запустите сервер и клиент:
  - одним скриптом: `npm run dev`
  - или отдельно: `npm run server` и в другом терминале `npm start`
- Откройте приложение: `http://localhost:3000/`.

## Страницы Bootstrap Wizard и RBAC Test

- `GET /bootstrap` — мастер начальной настройки: создаёт администратора и (по желанию) базовые роли.
- `GET /rbac-test` — тест RBAC: показывает доступные действия и маршруты по ролям текущего пользователя.

## Настройки пользователей и ролей

- `Settings → Users` (`/settings/users`) — список пользователей, мультиселект ролей, сохранение через API.
- `Settings → Roles` (`/settings/roles`) — CRUD ролей в DEV-режиме (in-memory) и в продакшне (MongoDB).

## DEV_MODE поведение

- При `AUTH_DEV_MODE=1` сервер работает без MongoDB: пользователи и роли хранятся в памяти процесса.
- Токены и авторизация упрощены; `bootstrap-admin` возвращает преднастроенного администратора.
- Данные обнуляются при перезапуске сервера.

## Продакшн

- Отключите DEV-режим: `AUTH_DEV_MODE=0`.
- Настройте базу: `MONGO_URI`, секреты: `JWT_SECRET`.
- Соберите клиент: `npm run build`. Запустите сервер: `npm start`.